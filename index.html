<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BPA Login</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f0f8ff; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .login-container { background: #fff; padding: 40px; border-radius: 10px; box-shadow: 0 0 20px rgba(0, 0, 0, 0.1); width: 350px; text-align: center; }
        .login-container h2 { color: #2e86c1; margin-top: 0; }
        .input-group { margin-bottom: 20px; text-align: left; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .input-group input { width: 100%; padding: 12px; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background-color: #2e86c1; color: #fff; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: bold; transition: background-color 0.3s; }
        button:hover { background: #1b4f72; }
        .error-message { color: #e74c3c; font-size: 14px; margin-top: 15px; }
    </style>
</head>
<body>
    <div class="login-container">
        <h2>Bharat Pashudhan App Login</h2>
        <form id="login-form">
            <div class="input-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="input-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit">Login</button>
            <p id="login-error" class="error-message"></p>
        </form>
    </div>
    <script>
        const backendURL = "https://bpa-backend-j1z3.onrender.com";
        document.addEventListener('DOMContentLoaded', () => {
            const loginForm = document.getElementById('login-form');
            const loginError = document.getElementById('login-error');
            if (loginForm) {
                loginForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;
                    if (!username || !password) {
                        loginError.textContent = 'Username and password are required.';
                        return;
                    }
                    try {
                        const res = await fetch(`${backendURL}/login`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ username, password, age: 0 })
                        });
                        const data = await res.json();
                        if (res.ok && data.success) {
                            localStorage.setItem('isLoggedIn', 'true');
                            window.location.href = 'dashboard.html';
                        } else {
                            loginError.textContent = data.message || 'Login failed. Please check your credentials.';
                        }
                    } catch (err) {
                        console.error("Login Error:", err);
                        loginError.textContent = 'Could not connect to the server. Try again.';
                    }
                });
            }
        });
    </script>
</body>
</html>
